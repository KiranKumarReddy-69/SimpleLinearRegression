import pandas as pd
import numpy as np
import matplotlib.pyplot as plt
from sklearn.model_selection import train_test_split
from sklearn.linear_model import LinearRegression
from sklearn.metrics import mean_squared_error, r2_score

df=pd.read_csv('/content/bostonhousing1603883195869.zip')

x=df['RM']
y=df['MEDV']

plt.scatter(x,y, color='orange')
plt.title('Relationship between RM and MEDV')
plt.xlabel('RM')
plt.ylabel('MEDV')
plt.show()

x_train,x_test,y_train,y_test=train_test_split(x,y,test_size=0.33, random_state=42)

model=LinearRegression()
model.fit(x_train.values.reshape(-1,1), y_train)

print("Coefficient:", model.coef_[0])
print("Intercept:", model.intercept_)

y_train_pred = model.predict(x_train.values.reshape(-1,1))
y_test_pred = model.predict(x_test.values.reshape(-1,1))

mse_train = mean_squared_error(y_train, y_train_pred)
mse_test = mean_squared_error(y_test, y_test_pred)

r2_train = r2_score(y_train, y_train_pred)
r2_test = r2_score(y_test, y_test_pred)

print("Training MSE:", mse_train)
print("Testing MSE:", mse_test)
print("Training R²:", r2_train)
print("Testing R²:", r2_test)
